<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jadwal Pelajaran</title>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script> <!-- SweetAlert Library -->
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
        }

        table, th, td {
            border: 1px solid black;
        }

        th, td {
            padding: 10px;
            text-align: left;
        }

        #runningText {
            margin-top: 20px;
            font-size: 20px;
            font-weight: bold;
            color: blue;
        }
    </style>
</head>
<body>
    <h1>Jadwal Pelajaran</h1>
    <table id="schedule">
        <!-- Tabel jadwal akan diisi secara dinamis -->
    </table>

    <div id="runningText">Selamat belajar!</div>

    <script>
        // Jadwal pelajaran
        const schedule = {
            "monday": [
                { "time": "7:10 - 9:10", "subject": "Matematika", "teacher": "Nita Rusdianita, S.Pd" },
                { "time": "9:10 - 9:30", "subject": "Istirahat", "teacher": "" },
                { "time": "9:30 - 10:40", "subject": "Pendidikan Pancasila", "teacher": "Sugiono, S.Pd" },
                { "time": "10:40 - 11:50", "subject": "Teknologi Jaringan Kabel", "teacher": "Indra Gunawan, S.Kom" },
                { "time": "11:50 - 12:10", "subject": "Istirahat", "teacher": "" },
                { "time": "12:10 - 13:20", "subject": "Bimbingan Konseling", "teacher": "Winarsih, S.Pd, MM" },
                { "time": "13:20 - 14:30", "subject": "Pendidikan Agama", "teacher": "C / T / S / K" }
            ],
            "tuesday": [
                { "time": "7:10 - 8:30", "subject": "Bahasa Inggris", "teacher": "Donna Morfini, S.Pd, M.Ikom" },
                { "time": "8:30 - 9:30", "subject": "Istirahat", "teacher": "" },
                { "time": "9:30 - 10:40", "subject": "Bahasa Indonesia", "teacher": "Setyorini P, M.Pd" },
                { "time": "10:40 - 12:45", "subject": "Pemasangan Perangkat", "teacher": "Encep Andi, S.T" },
                { "time": "12:45 - 14:30", "subject": "Teknologi Jaringan Kabel Dan Nirkabel", "teacher": "Indra Gunawan, S.Kom" }
            ],
            "wednesday": [
                { "time": "7:10 - 9:10", "subject": "Kewirausahaan", "teacher": "Danwayanah, S.S" },
                { "time": "9:10 - 9:30", "subject": "Istirahat", "teacher": "" },
                { "time": "9:30 - 10:40", "subject": "Bahasa Inggris", "teacher": "Donna Morfini, S.Pd, M.Ikom" },
                { "time": "10:40 - 12:45", "subject": "Administrasi Sistem Jaringan", "teacher": "Encep Andi, S.T" },
                { "time": "12:45 - 14:30", "subject": "Keamanan Jaringan", "teacher": "Encep Andi, S.T" }
            ],
            "thursday": [
                { "time": "7:10 - 8:30", "subject": "Kewirausahaan", "teacher": "Danwayanah, S.S" },
                { "time": "8:30 - 10:40", "subject": "Konfigurasi Perangkat", "teacher": "Encep Andi, S.T" },
                { "time": "10:40 - 12:45", "subject": "Sistem Jaringan", "teacher": "Encep Andi, S.T" },
                { "time": "12:45 - 13:55", "subject": "Perencanaan Jaringan", "teacher": "Encep Andi, S.T" },
                { "time": "13:55 - 14:30", "subject": "Budi Pekerti", "teacher": "Winarsih S.pd MM" }
            ],
            "friday": [
                { "time": "7:10 - 8:30", "subject": "Perencanaan Jaringan", "teacher": "Encep Andi, S.T" },
                { "time": "8:30 - 9:30", "subject": "Istirahat", "teacher": "" },
                { "time": "9:30 - 10:50", "subject": "Bahasa Mandarin", "teacher": "Loose Nicholas" }
            ]
        };

        // Tampilkan jadwal berdasarkan hari
        function showSchedule(day) {
            const now = new Date();
            const currentDay = now.getDay();
            const dayMap = {1: 'monday', 2: 'tuesday', 3: 'wednesday', 4: 'thursday', 5: 'friday'};
            const selectedDay = dayMap[day];

            // SweetAlert jika hari tidak ada pelajaran (Sabtu & Minggu)
            if (!dayMap[currentDay]) {
                Swal.fire({
                    icon: 'warning',
                    title: 'Tidak ada jadwal!',
                    text: 'Hari ini tidak ada pelajaran.',
                    confirmButtonText: 'Ok'
                });
                return;
            }

            // Kosongkan tabel sebelumnya
            const scheduleTable = document.getElementById("schedule");
            scheduleTable.innerHTML = "";

            const todaySchedule = schedule[day];
            todaySchedule.forEach(item => {
                const row = document.createElement("tr");
                const timeCell = document.createElement("td");
                const subjectCell = document.createElement("td");
                const teacherCell = document.createElement("td");

                timeCell.innerText = item.time;
                subjectCell.innerText = item.subject;
                teacherCell.innerText = item.teacher;

                // Highlight pelajaran yang sedang berlangsung
                if (isOngoingClass(item.time)) {
                    row.style.backgroundColor = "#ffeb3b"; // Warna highlight kuning
                    row.style.fontWeight = "bold";         // Teks tebal
                }

                row.appendChild(timeCell);
                row.appendChild(subjectCell);
                row.appendChild(teacherCell);
                scheduleTable.appendChild(row);
            });
        }

        // Cek apakah pelajaran sedang berlangsung
        function isOngoingClass(timeRange) {
            const now = new Date();
            const [startTime, endTime] = timeRange.split(" - ").map(time => {
                const [hours, minutes] = time.split(":").map(Number);
                return new Date(now.getFullYear(), now.getMonth(), now.getDate(), hours, minutes, 0);
            });

            return now >= startTime && now <= endTime; // Jika waktu sekarang di antara waktu mulai dan selesai
        }

        // Tampilkan jadwal hari ini secara default
        function showTodaySchedule() {
            const now = new Date();
            const currentDay = now.getDay();
            const dayMap = {1: 'monday', 2: 'tuesday', 3: 'wednesday', 4: 'thursday', 5: 'friday'};

            if (!dayMap[currentDay]) {
                Swal.fire({
                    icon: 'info',
                    title: 'Hari Libur!',
                    text: 'Tidak ada jadwal pelajaran pada hari ini.',
                    confirmButtonText: 'Oke'
                });
                return;
            }
            showSchedule(currentDay);
        }

        // Mulai running text
        function startRunningText() {
            const runningText = document.getElementById("runningText");
            let index = 0;
            
            // Dapatkan pelajaran selanjutnya berdasarkan jadwal hari ini
            function getNextClassText() {
                const now = new Date();
                const dayOfWeek = now.getDay(); // 0 = Minggu, 1 = Senin, dst.
                const dayMap = {1: 'monday', 2: 'tuesday', 3: 'wednesday', 4: 'thursday', 5: 'friday'};
                const today = dayMap[dayOfWeek];
                
                if (!today || !schedule[today]) {
                    return "Tidak ada jadwal untuk hari ini.";
                }

                const currentTime = now.getHours() * 60 + now.getMinutes(); // Jam saat ini dalam menit
                let nextClass = null;
                let remainingTime = null;

                // Loop melalui jadwal hari ini
                for (let item of schedule[today]) {
                    const [startHour, startMinute] = item.time.split(" - ")[0].split(":").map(Number);
                    const startTimeInMinutes = startHour * 60 + startMinute;

                    if (startTimeInMinutes > currentTime) {
                        nextClass = item;
                        remainingTime = startTimeInMinutes - currentTime;
                        break;
                    }
                }

                if (nextClass) {
                    const remainingHours = Math.floor(remainingTime / 60);
                    const remainingMinutes = remainingTime % 60;
                    const remainingText = remainingHours > 0 ? `${remainingHours} jam` : `${remainingMinutes} menit`;
                    return `Pelajaran selanjutnya yaitu ${nextClass.subject} dengan guru ${nextClass.teacher} dari jam ${nextClass.time}. Pelajaran akan dimulai dalam waktu ${remainingText}.`;
                } else {
                    return "Tidak ada pelajaran lagi untuk hari ini.";
                }
            }

            // Daftar teks berjalan, termasuk pelajaran selanjutnya
            function getRunningTexts() {
                const nextClassText = getNextClassText();
                return [
                    "Selamat belajar!",
                    "Periksa jadwal terbaru di sini.",
                    "Pastikan Anda sudah menyiapkan catatan!",
                    nextClassText
                ];
            }

            setInterval(() => {
                const texts = getRunningTexts(); // Ambil teks dinamis terbaru setiap interval
                runningText.innerText = texts[index];
                index = (index + 1) % texts.length;
            }, 3000);
        }

        // Panggil fungsi untuk memulai teks berjalan dan jadwal hari ini
        showTodaySchedule();
        startRunningText();
    </script>
</body>
</html>
