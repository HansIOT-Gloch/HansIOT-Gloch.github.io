<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Economic Game</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Basic styling for game elements */
        #game-container {
            display: none;
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center h-screen overflow-hidden">

    <!-- Username Form -->
    <div id="username-form" class="bg-white p-6 rounded-lg shadow-lg w-full max-w-md">
        <h1 class="text-2xl font-bold mb-4">Enter Username</h1>
        <input id="username" type="text" placeholder="Enter your username" class="border border-gray-300 p-2 rounded-lg w-full mb-4">
        <button onclick="setUsername()" class="bg-blue-500 text-white p-2 rounded-lg w-full">Submit</button>
        <p id="username-error" class="text-red-500 mt-2"></p>
    </div>

    <!-- Game Container -->
    <div id="game-container" class="bg-white p-6 rounded-lg shadow-lg w-full max-w-md">
        <h1 class="text-2xl font-bold mb-4">Economic Game</h1>
        <p id="money" class="text-xl mb-4">Money: $0</p>
        <button onclick="earnMoney()" class="bg-green-500 text-white p-2 rounded-lg w-full mb-4">Earn Money</button>
        <h2 class="text-xl font-semibold mb-2">Leaderboard</h2>
        <ul id="leaderboard" class="list-disc pl-5">
            <!-- Leaderboard will be updated here -->
        </ul>
    </div>

    <script>
        const USERNAME_KEY = 'username';
        const LEADERBOARD_KEY = 'leaderboard';

        function setUsername() {
            const usernameInput = document.getElementById('username');
            const username = usernameInput.value.trim();
            const errorElement = document.getElementById('username-error');

            if (!username) {
                errorElement.textContent = 'Username cannot be empty';
                return;
            }

            let leaderboard = JSON.parse(localStorage.getItem(LEADERBOARD_KEY)) || [];

            if (localStorage.getItem(USERNAME_KEY)) {
                errorElement.textContent = 'Username already set';
                return;
            }

            if (leaderboard.some(entry => entry.username === username)) {
                errorElement.textContent = 'Username already taken';
                return;
            }

            localStorage.setItem(USERNAME_KEY, username);
            localStorage.setItem('money', 0); // Initialize money

            document.getElementById('username-form').style.display = 'none';
            document.getElementById('game-container').style.display = 'block';

            // Start leaderboard update
            setInterval(updateLeaderboard, 30000);
            updateLeaderboard();
        }

        function earnMoney() {
            let money = parseInt(localStorage.getItem('money'), 10) || 0;
            money += 10; // Increase money by 10
            localStorage.setItem('money', money);
            document.getElementById('money').textContent = `Money: $${money}`;
        }

        function updateLeaderboard() {
            const leaderboard = JSON.parse(localStorage.getItem(LEADERBOARD_KEY)) || [];
            const username = localStorage.getItem(USERNAME_KEY);
            const money = parseInt(localStorage.getItem('money'), 10) || 0;

            // Update current user's money
            const existingEntry = leaderboard.find(entry => entry.username === username);
            if (existingEntry) {
                existingEntry.money = money;
            } else {
                leaderboard.push({ username, money });
            }

            // Sort leaderboard by money in descending order
            leaderboard.sort((a, b) => b.money - a.money);
            localStorage.setItem(LEADERBOARD_KEY, JSON.stringify(leaderboard));

            // Render leaderboard
            const leaderboardElement = document.getElementById('leaderboard');
            leaderboardElement.innerHTML = leaderboard.map(entry =>
                `<li>${entry.username}: $${entry.money}</li>`
            ).join('');
        }

        function checkForExistingUsername() {
            const username = localStorage.getItem(USERNAME_KEY);
            if (username) {
                document.getElementById('username-form').style.display = 'none';
                document.getElementById('game-container').style.display = 'block';
                updateLeaderboard(); // Ensure leaderboard is updated
            }
        }

        checkForExistingUsername();
    </script>
</body>
</html>
